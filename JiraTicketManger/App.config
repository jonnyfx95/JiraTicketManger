<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETCoreApp,Version=v8.0" />
  </startup>

  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <!-- ⚠️ BINDING REDIRECT per Office Interop -->
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Office.Interop.Outlook"
                          culture="neutral"
                          publicKeyToken="71e9bce111e9429c" />
        <bindingRedirect oldVersion="0.0.0.0-15.0.0.0" newVersion="15.0.0.0" />
      </dependentAssembly>

      <!-- ⚠️ BINDING REDIRECT per Office (assembly principale) -->
      <dependentAssembly>
        <assemblyIdentity name="office"
                          culture="neutral"
                          publicKeyToken="71e9bce111e9429c" />
        <bindingRedirect oldVersion="0.0.0.0-15.0.0.0" newVersion="15.0.0.0" />
      </dependentAssembly>

      <!-- ⚠️ BINDING REDIRECT per Microsoft.Vbe.Interop -->
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Vbe.Interop"
                          culture="neutral"
                          publicKeyToken="71e9bce111e9429c" />
        <bindingRedirect oldVersion="0.0.0.0-15.0.0.0" newVersion="15.0.0.0" />
      </dependentAssembly>
    </assemblyBinding>

    <!-- ⚠️ CONFIGURAZIONE per COM Interop moderno -->
    <gcServer enabled="true" />
    <gcConcurrent enabled="true" />

    <!-- ⚠️ COMPATIBILITÀ con Office moderno -->
    <AppContextSwitchOverrides value="Switch.System.Runtime.Serialization.UseInsecureBinaryFormatterSerialization=false" />
  </runtime>

  <!-- ⚠️ CONFIGURAZIONE per .NET 8 + COM -->
  <system.runtime.remoting>
    <application>
      <channels>
        <channel ref="http" port="0" />
      </channels>
    </application>
  </system.runtime.remoting>
</configuration>